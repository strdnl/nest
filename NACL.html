<html>
<body>
<script src="https://tweetnacl.js.org/mithril.min.js"></script>
  <script src="https://tweetnacl.js.org/nacl.min.js"></script>
  <script src="https://tweetnacl.js.org/nacl-util.min.js"></script>
 <script>
var cock = nacl.box.keyPair();
console.log(cock.publicKey);
console.log(cock.secretKey);
var cock2 = nacl.box.keyPair();
console.log(cock2);
var secret = nacl.box.before(cock2.publicKey,cock.secretKey);
var secret2 = nacl.util.encodeBase64(nacl.box.before(cock.publicKey, cock2.secretKey));

console.log(secret2);
var session = nacl.sign.keyPair();
var sessionpub =  nacl.util.encodeBase64(session.publicKey);
var sessionpriv =  nacl.util.encodeBase64(session.secretKey);
console.log(sessionpub + " and priv: " + sessionpriv);
var nonce = nacl.randomBytes(24);
var encd = nacl.secretbox(nacl.util.decodeUTF8("data:text/html;base64,DQo8aHRtbD4NCiAgPGhlYWQ+DQogICAgPHRpdGxlPkphdmFTY3JpcHQgRUNESCBLZXkgRXhjaGFuZ2UgRGVtbzwvdGl0bGU+DQoNCjxzY3JpcHQgbGFuZ3VhZ2U9IkphdmFTY3JpcHQiIHR5cGU9InRleHQvamF2YXNjcmlwdCIgc3JjPSJqc2JuLmpzIj48L3NjcmlwdD4NCjxzY3JpcHQgbGFuZ3VhZ2U9IkphdmFTY3JpcHQiIHR5cGU9InRleHQvamF2YXNjcmlwdCIgc3JjPSJqc2JuMi5qcyI+PC9zY3JpcHQ+DQo8c2NyaXB0IGxhbmd1YWdlPSJKYXZhU2NyaXB0IiB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiIHNyYz0icHJuZzQuanMiPjwvc2NyaXB0Pg0KPHNjcmlwdCBsYW5ndWFnZT0iSmF2YVNjcmlwdCIgdHlwZT0idGV4dC9qYXZhc2NyaXB0IiBzcmM9InJuZy5qcyI+PC9zY3JpcHQ+DQo8c2NyaXB0IGxhbmd1YWdlPSJKYXZhU2NyaXB0IiB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiIHNyYz0iZWMuanMiPjwvc2NyaXB0Pg0KPHNjcmlwdCBsYW5ndWFnZT0iSmF2YVNjcmlwdCIgdHlwZT0idGV4dC9qYXZhc2NyaXB0IiBzcmM9InNlYy5qcyI+PC9zY3JpcHQ+DQo8c2NyaXB0IGxhbmd1YWdlPSJKYXZhU2NyaXB0IiB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiIHNyYz0ic2pjbC5qcyI+PC9zY3JpcHQ+DQoNCjxzY3JpcHQgbGFuZ3VhZ2U9IkphdmFTY3JpcHQiPg0KPCEtLQ0KZnVuY3Rpb24gZG9fc3RhdHVzKHMpIHsNCiAgZG9jdW1lbnQuZWNkaHRlc3Quc3RhdHVzLnZhbHVlID0gczsNCn0NCg0KZnVuY3Rpb24gc2V0X2VjX3BhcmFtcyhuYW1lKSB7DQogIHZhciBjID0gZ2V0U0VDQ3VydmVCeU5hbWUobmFtZSk7DQoNCiAgZG9jdW1lbnQuZWNkaHRlc3QucS52YWx1ZSA9IGMuZ2V0Q3VydmUoKS5nZXRRKCkudG9TdHJpbmcoKTsNCiAgZG9jdW1lbnQuZWNkaHRlc3QuYS52YWx1ZSA9IGMuZ2V0Q3VydmUoKS5nZXRBKCkudG9CaWdJbnRlZ2VyKCkudG9TdHJpbmcoKTsNCiAgZG9jdW1lbnQuZWNkaHRlc3QuYi52YWx1ZSA9IGMuZ2V0Q3VydmUoKS5nZXRCKCkudG9CaWdJbnRlZ2VyKCkudG9TdHJpbmcoKTsNCiAgZG9jdW1lbnQuZWNkaHRlc3QuZ3gudmFsdWUgPSBjLmdldEcoKS5nZXRYKCkudG9CaWdJbnRlZ2VyKCkudG9TdHJpbmcoKTsNCiAgZG9jdW1lbnQuZWNkaHRlc3QuZ3kudmFsdWUgPSBjLmdldEcoKS5nZXRZKCkudG9CaWdJbnRlZ2VyKCkudG9TdHJpbmcoKTsNCiAgZG9jdW1lbnQuZWNkaHRlc3Qubi52YWx1ZSA9IGMuZ2V0TigpLnRvU3RyaW5nKCk7DQoNCiAgLy8gQ2hhbmdpbmcgRUMgcGFyYW1zIGludmFsaWRhdGVzIGV2ZXJ5dGhpbmcgZWxzZQ0KICBkb2N1bWVudC5lY2RodGVzdC5hbGljZV9wcml2LnZhbHVlID0gIiI7DQogIGRvY3VtZW50LmVjZGh0ZXN0LmJvYl9wcml2LnZhbHVlID0gIiI7DQogIGRvY3VtZW50LmVjZGh0ZXN0LmFsaWNlX3B1Yl94LnZhbHVlID0gIiI7DQogIGRvY3VtZW50LmVjZGh0ZXN0LmFsaWNlX3B1Yl95LnZhbHVlID0gIiI7DQogIGRvY3VtZW50LmVjZGh0ZXN0LmJvYl9wdWJfeC52YWx1ZSA9ICIiOw0KICBkb2N1bWVudC5lY2RodGVzdC5ib2JfcHViX3kudmFsdWUgPSAiIjsNCiAgZG9jdW1lbnQuZWNkaHRlc3QuYWxpY2Vfa2V5X3gudmFsdWUgPSAiIjsNCiAgZG9jdW1lbnQuZWNkaHRlc3QuYWxpY2Vfa2V5X3kudmFsdWUgPSAiIjsNCiAgZG9jdW1lbnQuZWNkaHRlc3QuYm9iX2tleV94LnZhbHVlID0gIiI7DQogIGRvY3VtZW50LmVjZGh0ZXN0LmJvYl9rZXlfeS52YWx1ZSA9ICIiOw0KDQogIGRvX3N0YXR1cygiVXNpbmcgIiArIG5hbWUgKyAiIEVDIHBhcmFtZXRlcnMiKTsNCn0NCg0KZnVuY3Rpb24gc2V0X3NlY3AxMjhyMSgpIHsNCiAgc2V0X2VjX3BhcmFtcygic2VjcDEyOHIxIik7DQp9DQoNCmZ1bmN0aW9uIHNldF9zZWNwMTYwazEoKSB7DQogIHNldF9lY19wYXJhbXMoInNlY3AxNjBrMSIpOw0KfQ0KDQpmdW5jdGlvbiBzZXRfc2VjcDE2MHIxKCkgew0KICBzZXRfZWNfcGFyYW1zKCJzZWNwMTYwcjEiKTsNCn0NCg0KZnVuY3Rpb24gc2V0X3NlY3AxOTJrMSgpIHsNCiAgc2V0X2VjX3BhcmFtcygic2VjcDE5MmsxIik7DQp9DQoNCmZ1bmN0aW9uIHNldF9zZWNwMTkycjEoKSB7DQogIHNldF9lY19wYXJhbXMoInNlY3AxOTJyMSIpOw0KfQ0KDQpmdW5jdGlvbiBzZXRfc2VjcDIyNHIxKCkgew0KICBzZXRfZWNfcGFyYW1zKCJzZWNwMjI0cjEiKTsNCn0NCg0KZnVuY3Rpb24gc2V0X3NlY3AyNTZyMSgpIHsNCiAgc2V0X2VjX3BhcmFtcygic2VjcDI1NnIxIik7DQp9DQoNCnZhciBybmc7DQoNCmZ1bmN0aW9uIGRvX2luaXQoKSB7DQogIGlmKGRvY3VtZW50LmVjZGh0ZXN0LnEudmFsdWUubGVuZ3RoID09IDApIHNldF9zZWNwMTYwcjEoKTsNCiAgcm5nID0gbmV3IFNlY3VyZVJhbmRvbSgpOw0KfQ0KDQpmdW5jdGlvbiBnZXRfY3VydmUoKSB7DQogIHJldHVybiBuZXcgRUNDdXJ2ZUZwKG5ldyBCaWdJbnRlZ2VyKGRvY3VtZW50LmVjZGh0ZXN0LnEudmFsdWUpLA0KICAgIG5ldyBCaWdJbnRlZ2VyKGRvY3VtZW50LmVjZGh0ZXN0LmEudmFsdWUpLA0KICAgIG5ldyBCaWdJbnRlZ2VyKGRvY3VtZW50LmVjZGh0ZXN0LmIudmFsdWUpKTsNCn0NCg0KZnVuY3Rpb24gZ2V0X0coY3VydmUpIHsNCiAgcmV0dXJuIG5ldyBFQ1BvaW50RnAoY3VydmUsDQogICAgY3VydmUuZnJvbUJpZ0ludGVnZXIobmV3IEJpZ0ludGVnZXIoZG9jdW1lbnQuZWNkaHRlc3QuZ3gudmFsdWUpKSwNCiAgICBjdXJ2ZS5mcm9tQmlnSW50ZWdlcihuZXcgQmlnSW50ZWdlcihkb2N1bWVudC5lY2RodGVzdC5neS52YWx1ZSkpKTsNCn0NCg0KZnVuY3Rpb24gcGlja19yYW5kKCkgew0KICB2YXIgbiA9IG5ldyBCaWdJbnRlZ2VyKGRvY3VtZW50LmVjZGh0ZXN0Lm4udmFsdWUpOw0KICB2YXIgbjEgPSBuLnN1YnRyYWN0KEJpZ0ludGVnZXIuT05FKTsNCiAgdmFyIHIgPSBuZXcgQmlnSW50ZWdlcihuLmJpdExlbmd0aCgpLCBybmcpOw0KICByZXR1cm4gci5tb2QobjEpLmFkZChCaWdJbnRlZ2VyLk9ORSk7DQp9DQoNCmZ1bmN0aW9uIGRvX2FsaWNlX3JhbmQoKSB7DQogIHZhciByID0gcGlja19yYW5kKCk7DQogIGRvY3VtZW50LmVjZGh0ZXN0LmFsaWNlX3ByaXYudmFsdWUgPSByLnRvU3RyaW5nKCk7DQogIGRvY3VtZW50LmVjZGh0ZXN0LmFsaWNlX3B1Yl94LnZhbHVlID0gIiI7DQogIGRvY3VtZW50LmVjZGh0ZXN0LmFsaWNlX3B1Yl95LnZhbHVlID0gIiI7DQogIGRvY3VtZW50LmVjZGh0ZXN0LmFsaWNlX2tleV94LnZhbHVlID0gIiI7DQogIGRvY3VtZW50LmVjZGh0ZXN0LmFsaWNlX2tleV95LnZhbHVlID0gIiI7DQogIGRvY3VtZW50LmVjZGh0ZXN0LmJvYl9rZXlfeC52YWx1ZSA9ICIiOw0KICBkb2N1bWVudC5lY2RodGVzdC5ib2Jfa2V5X3kudmFsdWUgPSAiIjsNCiAgZG9fc3RhdHVzKCJBbGljZSdzIHJhbmRvbSB2YWx1ZSBnZW5lcmF0ZWQiKTsNCn0NCg0KZnVuY3Rpb24gZG9fYm9iX3JhbmQoKSB7DQogIHZhciByID0gcGlja19yYW5kKCk7DQogIGRvY3VtZW50LmVjZGh0ZXN0LmJvYl9wcml2LnZhbHVlID0gci50b1N0cmluZygpOw0KICBkb2N1bWVudC5lY2RodGVzdC5ib2JfcHViX3gudmFsdWUgPSAiIjsNCiAgZG9jdW1lbnQuZWNkaHRlc3QuYm9iX3B1Yl95LnZhbHVlID0gIiI7DQogIGRvY3VtZW50LmVjZGh0ZXN0LmFsaWNlX2tleV94LnZhbHVlID0gIiI7DQogIGRvY3VtZW50LmVjZGh0ZXN0LmFsaWNlX2tleV95LnZhbHVlID0gIiI7DQogIGRvY3VtZW50LmVjZGh0ZXN0LmJvYl9rZXlfeC52YWx1ZSA9ICIiOw0KICBkb2N1bWVudC5lY2RodGVzdC5ib2Jfa2V5X3kudmFsdWUgPSAiIjsNCiAgZG9fc3RhdHVzKCJCb2IncyByYW5kb20gdmFsdWUgZ2VuZXJhdGVkIik7DQp9DQoNCmZ1bmN0aW9uIGRvX2FsaWNlX3B1YigpIHsNCiAgaWYoZG9jdW1lbnQuZWNkaHRlc3QuYWxpY2VfcHJpdi52YWx1ZS5sZW5ndGggPT0gMCkgew0KICAgIGFsZXJ0KCJQbGVhc2UgZ2VuZXJhdGUgQWxpY2UncyBwcml2YXRlIHZhbHVlIGZpcnN0Iik7DQogICAgcmV0dXJuOw0KICB9DQogIHZhciBiZWZvcmUgPSBuZXcgRGF0ZSgpOw0KICB2YXIgY3VydmUgPSBnZXRfY3VydmUoKTsNCiAgdmFyIEcgPSBnZXRfRyhjdXJ2ZSk7DQogIHZhciBhID0gbmV3IEJpZ0ludGVnZXIoZG9jdW1lbnQuZWNkaHRlc3QuYWxpY2VfcHJpdi52YWx1ZSk7DQogIHZhciBQID0gRy5tdWx0aXBseShhKTsNCiAgdmFyIGFmdGVyID0gbmV3IERhdGUoKTsNCiAgZG9jdW1lbnQuZWNkaHRlc3QuYWxpY2VfcHViX3gudmFsdWUgPSBQLmdldFgoKS50b0JpZ0ludGVnZXIoKS50b1N0cmluZygpOw0KICBkb2N1bWVudC5lY2RodGVzdC5hbGljZV9wdWJfeS52YWx1ZSA9IFAuZ2V0WSgpLnRvQmlnSW50ZWdlcigpLnRvU3RyaW5nKCk7DQogIGRvY3VtZW50LmVjZGh0ZXN0LmJvYl9rZXlfeC52YWx1ZSA9ICIiOw0KICBkb2N1bWVudC5lY2RodGVzdC5ib2Jfa2V5X3kudmFsdWUgPSAiIjsNCiAgZG9fc3RhdHVzKCJBbGljZSdzIHB1YmxpYyBwb2ludCBjb21wdXRlZCBpbiAiICsgKGFmdGVyIC0gYmVmb3JlKSArICJtcyIpOw0KfQ0KDQpmdW5jdGlvbiBkb19ib2JfcHViKCkgew0KICBpZihkb2N1bWVudC5lY2RodGVzdC5ib2JfcHJpdi52YWx1ZS5sZW5ndGggPT0gMCkgew0KICAgIGFsZXJ0KCJQbGVhc2UgZ2VuZXJhdGUgQm9iJ3MgcHJpdmF0ZSB2YWx1ZSBmaXJzdCIpOw0KICAgIHJldHVybjsNCiAgfQ0KICB2YXIgYmVmb3JlID0gbmV3IERhdGUoKTsNCiAgdmFyIGN1cnZlID0gZ2V0X2N1cnZlKCk7DQogIHZhciBHID0gZ2V0X0coY3VydmUpOw0KICB2YXIgYSA9IG5ldyBCaWdJbnRlZ2VyKGRvY3VtZW50LmVjZGh0ZXN0LmJvYl9wcml2LnZhbHVlKTsNCiAgdmFyIFAgPSBHLm11bHRpcGx5KGEpOw0KICB2YXIgYWZ0ZXIgPSBuZXcgRGF0ZSgpOw0KICBkb2N1bWVudC5lY2RodGVzdC5ib2JfcHViX3gudmFsdWUgPSBQLmdldFgoKS50b0JpZ0ludGVnZXIoKS50b1N0cmluZygpOw0KICBkb2N1bWVudC5lY2RodGVzdC5ib2JfcHViX3kudmFsdWUgPSBQLmdldFkoKS50b0JpZ0ludGVnZXIoKS50b1N0cmluZygpOw0KICBkb2N1bWVudC5lY2RodGVzdC5hbGljZV9rZXlfeC52YWx1ZSA9ICIiOw0KICBkb2N1bWVudC5lY2RodGVzdC5hbGljZV9rZXlfeS52YWx1ZSA9ICIiOw0KICBkb19zdGF0dXMoIkJvYidzIHB1YmxpYyBwb2ludCBjb21wdXRlZCBpbiAiICsgKGFmdGVyIC0gYmVmb3JlKSArICJtcyIpOw0KfQ0KDQpmdW5jdGlvbiBkb19hbGljZV9rZXkoKSB7DQogIGlmKGRvY3VtZW50LmVjZGh0ZXN0LmFsaWNlX3ByaXYudmFsdWUubGVuZ3RoID09IDApIHsNCiAgICBhbGVydCgiUGxlYXNlIGdlbmVyYXRlIEFsaWNlJ3MgcHJpdmF0ZSB2YWx1ZSBmaXJzdCIpOw0KICAgIHJldHVybjsNCiAgfQ0KICBpZihkb2N1bWVudC5lY2RodGVzdC5ib2JfcHViX3gudmFsdWUubGVuZ3RoID09IDApIHsNCiAgICBhbGVydCgiUGxlYXNlIGNvbXB1dGUgQm9iJ3MgcHVibGljIHZhbHVlIGZpcnN0Iik7DQogICAgcmV0dXJuOw0KICB9DQogIHZhciBiZWZvcmUgPSBuZXcgRGF0ZSgpOw0KICB2YXIgY3VydmUgPSBnZXRfY3VydmUoKTsNCiAgdmFyIFAgPSBuZXcgRUNQb2ludEZwKGN1cnZlLA0KICAgIGN1cnZlLmZyb21CaWdJbnRlZ2VyKG5ldyBCaWdJbnRlZ2VyKGRvY3VtZW50LmVjZGh0ZXN0LmJvYl9wdWJfeC52YWx1ZSkpLA0KICAgIGN1cnZlLmZyb21CaWdJbnRlZ2VyKG5ldyBCaWdJbnRlZ2VyKGRvY3VtZW50LmVjZGh0ZXN0LmJvYl9wdWJfeS52YWx1ZSkpKTsNCiAgdmFyIGEgPSBuZXcgQmlnSW50ZWdlcihkb2N1bWVudC5lY2RodGVzdC5hbGljZV9wcml2LnZhbHVlKTsNCiAgdmFyIFMgPSBQLm11bHRpcGx5KGEpOw0KICB2YXIgYWZ0ZXIgPSBuZXcgRGF0ZSgpOw0KICBkb2N1bWVudC5lY2RodGVzdC5hbGljZV9rZXlfeC52YWx1ZSA9IFMuZ2V0WCgpLnRvQmlnSW50ZWdlcigpLnRvU3RyaW5nKCk7DQogIGRvY3VtZW50LmVjZGh0ZXN0LmFsaWNlX2tleV95LnZhbHVlID0gUy5nZXRZKCkudG9CaWdJbnRlZ2VyKCkudG9TdHJpbmcoKTsNCiAgZG9fc3RhdHVzKCJBbGljZSdzIGtleSBkZXJpdmVkIGluICIgKyAoYWZ0ZXIgLSBiZWZvcmUpICsgIm1zIik7DQp9DQoNCmZ1bmN0aW9uIGRvX2JvYl9rZXkoKSB7DQogIGlmKGRvY3VtZW50LmVjZGh0ZXN0LmJvYl9wcml2LnZhbHVlLmxlbmd0aCA9PSAwKSB7DQogICAgYWxlcnQoIlBsZWFzZSBnZW5lcmF0ZSBCb2IncyBwcml2YXRlIHZhbHVlIGZpcnN0Iik7DQogICAgcmV0dXJuOw0KICB9DQogIGlmKGRvY3VtZW50LmVjZGh0ZXN0LmFsaWNlX3B1Yl94LnZhbHVlLmxlbmd0aCA9PSAwKSB7DQogICAgYWxlcnQoIlBsZWFzZSBjb21wdXRlIEFsaWNlJ3MgcHVibGljIHZhbHVlIGZpcnN0Iik7DQogICAgcmV0dXJuOw0KICB9DQogIHZhciBiZWZvcmUgPSBuZXcgRGF0ZSgpOw0KICB2YXIgY3VydmUgPSBnZXRfY3VydmUoKTsNCiAgdmFyIFAgPSBuZXcgRUNQb2ludEZwKGN1cnZlLA0KICAgIGN1cnZlLmZyb21CaWdJbnRlZ2VyKG5ldyBCaWdJbnRlZ2VyKGRvY3VtZW50LmVjZGh0ZXN0LmFsaWNlX3B1Yl94LnZhbHVlKSksDQogICAgY3VydmUuZnJvbUJpZ0ludGVnZXIobmV3IEJpZ0ludGVnZXIoZG9jdW1lbnQuZWNkaHRlc3QuYWxpY2VfcHViX3kudmFsdWUpKSk7DQogIHZhciBhID0gbmV3IEJpZ0ludGVnZXIoZG9jdW1lbnQuZWNkaHRlc3QuYm9iX3ByaXYudmFsdWUpOw0KICB2YXIgUyA9IFAubXVsdGlwbHkoYSk7DQogIHZhciBhZnRlciA9IG5ldyBEYXRlKCk7DQogIGRvY3VtZW50LmVjZGh0ZXN0LmJvYl9rZXlfeC52YWx1ZSA9IFMuZ2V0WCgpLnRvQmlnSW50ZWdlcigpLnRvU3RyaW5nKCk7DQogIGRvY3VtZW50LmVjZGh0ZXN0LmJvYl9rZXlfeS52YWx1ZSA9IFMuZ2V0WSgpLnRvQmlnSW50ZWdlcigpLnRvU3RyaW5nKCk7DQogIGRvX3N0YXR1cygiQm9iJ3Mga2V5IGRlcml2ZWQgaW4gIiArIChhZnRlciAtIGJlZm9yZSkgKyAibXMiKTsNCn0NCi8vLS0+DQo8L3NjcmlwdD4NCiAgPC9oZWFkPg0KDQogIDxib2R5IG9uTG9hZD0nZG9faW5pdCgpOyc+DQogICAgPGgxPkphdmFTY3JpcHQgRUNESCBLZXkgRXhjaGFuZ2UgRGVtbzwvaDE+DQoNCjxmb3JtIG5hbWU9ImVjZGh0ZXN0IiBvblN1Ym1pdD0ncmV0dXJuIGZhbHNlOyc+DQo8dGFibGU+DQo8dHI+PHRoPkFsaWNlPC90aD48dGg+Qm9iPC90aD48L3RyPg0KPHRyPg0KPHRkPg0KW1N0ZXAgMV0gQWxpY2UncyBwcml2YXRlIHZhbHVlICg8aT5hPC9pPik6PGJyPg0KPGlucHV0IG5hbWU9ImFsaWNlX3ByaXYiIHR5cGU9InRleHQiIHZhbHVlPSIiIHNpemU9ODA+PGJyPg0KPGlucHV0IHR5cGU9ImJ1dHRvbiIgdmFsdWU9InJhbmRvbSIgb25DbGljaz0iZG9fYWxpY2VfcmFuZCgpOyI+PHA+DQpbU3RlcCAzXSBBbGljZSdzIHB1YmxpYyBwb2ludCAoPGk+QSA9IGFHPC9pPikgKFgsWSk6PGJyPg0KPGlucHV0IG5hbWU9ImFsaWNlX3B1Yl94IiB0eXBlPSJ0ZXh0IiB2YWx1ZT0iIiBzaXplPTgwPjxicj4NCjxpbnB1dCBuYW1lPSJhbGljZV9wdWJfeSIgdHlwZT0idGV4dCIgdmFsdWU9IiIgc2l6ZT04MD48YnI+DQo8aW5wdXQgdHlwZT0iYnV0dG9uIiB2YWx1ZT0iY29tcHV0ZSBwdWJsaWMiIG9uQ2xpY2s9ImRvX2FsaWNlX3B1YigpOyI+PHA+DQpbU3RlcCA1XSBBbGljZSdzIHNlY3JldCBrZXkgKDxpPlMgPSBhQiA9IGFiRzwvaT4pIChYLFkpOjxicj4NCjxpbnB1dCBuYW1lPSJhbGljZV9rZXlfeCIgdHlwZT0idGV4dCIgdmFsdWU9IiIgc2l6ZT04MD48YnI+DQo8aW5wdXQgbmFtZT0iYWxpY2Vfa2V5X3kiIHR5cGU9InRleHQiIHZhbHVlPSIiIHNpemU9ODA+PGJyPg0KPGlucHV0IHR5cGU9ImJ1dHRvbiIgdmFsdWU9ImRlcml2ZSBzZWNyZXQiIG9uQ2xpY2s9ImRvX2FsaWNlX2tleSgpOyI+DQo8L3RkPg0KPHRkPg0KW1N0ZXAgMl0gQm9iJ3MgcHJpdmF0ZSB2YWx1ZSAoPGk+YjwvaT4pOjxicj4NCjxpbnB1dCBuYW1lPSJib2JfcHJpdiIgdHlwZT0idGV4dCIgdmFsdWU9IiIgc2l6ZT04MD48YnI+DQo8aW5wdXQgdHlwZT0iYnV0dG9uIiB2YWx1ZT0icmFuZG9tIiBvbkNsaWNrPSJkb19ib2JfcmFuZCgpOyI+PHA+DQpbU3RlcCA0XSBCb2IncyBwdWJsaWMgcG9pbnQgKDxpPkIgPSBiRzwvaT4pIChYLFkpOjxicj4NCjxpbnB1dCBuYW1lPSJib2JfcHViX3giIHR5cGU9InRleHQiIHZhbHVlPSIiIHNpemU9ODA+PGJyPg0KPGlucHV0IG5hbWU9ImJvYl9wdWJfeSIgdHlwZT0idGV4dCIgdmFsdWU9IiIgc2l6ZT04MD48YnI+DQo8aW5wdXQgdHlwZT0iYnV0dG9uIiB2YWx1ZT0iY29tcHV0ZSBwdWJsaWMiIG9uQ2xpY2s9ImRvX2JvYl9wdWIoKTsiPjxwPg0KW1N0ZXAgNl0gQm9iJ3Mgc2VjcmV0IGtleSAoPGk+UyA9IGJBID0gYmFHPC9pPikgKFgsWSk6PGJyPg0KPGlucHV0IG5hbWU9ImJvYl9rZXlfeCIgdHlwZT0idGV4dCIgdmFsdWU9IiIgc2l6ZT04MD48YnI+DQo8aW5wdXQgbmFtZT0iYm9iX2tleV95IiB0eXBlPSJ0ZXh0IiB2YWx1ZT0iIiBzaXplPTgwPjxicj4NCjxpbnB1dCB0eXBlPSJidXR0b24iIHZhbHVlPSJkZXJpdmUgc2VjcmV0IiBvbkNsaWNrPSJkb19ib2Jfa2V5KCk7Ij4NCjwvdGQ+DQo8L3RyPg0KPC90YWJsZT4NCjxwPlN0YXR1czo8YnI+DQo8aW5wdXQgbmFtZT0ic3RhdHVzIiB0eXBlPSJ0ZXh0IiBzaXplPTYwPjxwPg0KPGhyPg0KPGgyPkVsbGlwdGljIEN1cnZlIHBhcmFtZXRlcnM8L2gyPjxwPg0KPGlucHV0IHR5cGU9ImJ1dHRvbiIgdmFsdWU9ImN1cnZlMjU1MTkiIG9uQ2xpY2s9J3NldF9zZWNwMTI4cjEoKTsnPg0KPGlucHV0IHR5cGU9ImJ1dHRvbiIgdmFsdWU9Im01MTEiIG9uQ2xpY2s9J3NldF9zZWNwMTYwazEoKTsnPg0KPGlucHV0IHR5cGU9ImJ1dHRvbiIgdmFsdWU9Im0yMjEgKGRlZmF1bHQpIiBvbkNsaWNrPSdzZXRfc2VjcDE2MHIxKCk7Jz4NCjxpbnB1dCB0eXBlPSJidXR0b24iIHZhbHVlPSJtMzgzIiBvbkNsaWNrPSdzZXRfc2VjcDE5MmsxKCk7Jz4NCjxpbnB1dCB0eXBlPSJidXR0b24iIHZhbHVlPSJzZWNwMTkycjEiIG9uQ2xpY2s9J3NldF9zZWNwMTkycjEoKTsnPg0KPGlucHV0IHR5cGU9ImJ1dHRvbiIgdmFsdWU9InNlY3AyMjRyMSIgb25DbGljaz0nc2V0X3NlY3AyMjRyMSgpOyc+DQo8aW5wdXQgdHlwZT0iYnV0dG9uIiB2YWx1ZT0ic2VjcDI1NnIxIiBvbkNsaWNrPSdzZXRfc2VjcDI1NnIxKCk7Jz4NCjxwPg0KQ3VydmUgUTo8YnI+DQo8aW5wdXQgbmFtZT0icSIgdHlwZT0idGV4dCIgc2l6ZT0xMDA+PGJyPg0KQ3VydmUgQTo8YnI+DQo8aW5wdXQgbmFtZT0iYSIgdHlwZT0idGV4dCIgc2l6ZT0xMDA+PGJyPg0KQ3VydmUgQjo8YnI+DQo8aW5wdXQgbmFtZT0iYiIgdHlwZT0idGV4dCIgc2l6ZT0xMDA+PHA+DQpHIChYLFkpOjxicj4NCjxpbnB1dCBuYW1lPSJneCIgdHlwZT0idGV4dCIgc2l6ZT0xMDA+PGJyPg0KPGlucHV0IG5hbWU9Imd5IiB0eXBlPSJ0ZXh0IiBzaXplPTEwMD48cD4NCk46PGJyPg0KPGlucHV0IG5hbWU9Im4iIHR5cGU9InRleHQiIHNpemU9MTAwPjxwPg0KPC9mb3JtPg0KPGhyPg0KPGgyPk5vdGVzPC9oMj4NCjx1bD4NCjxsaT5QZXJmb3JtYW5jZSBkYXRhIG1vdmVkIHRvIHRoZSA8YSBocmVmPSJzcGVlZC5odG1sIj5zcGVlZCB0YWJsZXM8L2E+DQo8bGk+SW1wbGVtZW50YXRpb24gYmFzZWQgb24gQm91bmN5Q2FzdGxlJ3MgSmF2YSBFQyBjb2RlDQo8bGk+UG9pbnQgY29tcHJlc3Npb24gbm90IHN1cHBvcnRlZA0KPGxpPk9ubHkgY3VydmVzIG92ZXIgRihwKSBzdXBwb3J0ZWQsIG5vIEYoMjxzdXA+bTwvc3VwPikgc3VwcG9ydCB5ZXQNCjxsaT5BZGRpdGlvbmFsIHBlcmZvcm1hbmNlIG9wdGltaXphdGlvbnMgKGUuZy4gd2luZG93ZWQgbXVsdGlwbGllcikgbm90IHlldCBleHBsb2l0ZWQNCjxsaT5Nb3JlIGVycm9yIGNoZWNraW5nIG5lZWRlZA0KPGxpPk5lZWQgYSBzd2l0Y2ggdG8gZGlzcGxheSBoZXggdmFsdWVzIGluIGRlbW8NCjwvdWw+DQogICAgPGhyPg0KICAgIDxhZGRyZXNzPjxhIGhyZWY9Im1haWx0bzp0andAY3Muc3RhbmZvcmQuZWR1Ij5Ub20gV3U8L2E+PC9hZGRyZXNzPg0KICA8L2JvZHk+DQo8L2h0bWw+DQo="), nonce, secret);
console.log(encd);
var decd = nacl.secretbox.open(encd, nonce, secret);
console.log(nacl.util.encodeUTF8(decd));
var sign = nacl.sign.detached(encd, session.secretKey);
var ver = nacl.sign.detached.verify(encd, sign, session.publicKey);
console.log(ver);

</script>

</body></html>